{% import "backend/macros.html" as s with context %}
{%- if scaffolding -%}
    {%- if route.action == 'add' -%}
        {% set submit_text ="建立" %}
        {% set submit_and_exit_text ="建立並離開" %}
        {% set submit_and_reload_record ="建立並繼續編輯" %}
    {% else %}
        {% set submit_text ="儲存" %}
        {% set submit_and_exit_text ="儲存並離開" %}
    {% endif %}
    <a href="javascript: history.go(-1);" class="btn btn-white btn-display-in-iframe"><i class="icon">keyboard_backspace</i><span class="hidden-xs"> 回上一頁</span></a>
    <div class="btn-group">
        {%- if route.action != 'view' -%}
        <a href="javascript: saveForm();" class="btn btn-white"><i class="icon">save</i> {{ submit_text }}</a>
        <a href="javascript: saveFormAndGoBack();" class="btn btn-white"><i class="icon">save</i> {{ submit_and_exit_text }}</a>
        {% endif %}
        {%- if route.action == 'add' -%}
        <a href="javascript: saveFormAndReloadRecord();" class="btn btn-white"><i class="icon">save</i> {{ submit_and_reload_record }}</a>
        {% endif %}
    </div>

    <div class="dropdown list-operations related-operations hide pull-right">
        <a class="dropdown-toggle text-black waves-attach padding-left-no padding-right-no waves-effect btn btn-white"
           data-toggle="dropdown">
            <span><i class="icon icon-lg">arrow_drop_down</i></span>
            <span class="hidden-xs">相關操作</span><span class="visible-xs">操作</span>
        </a>
        <ul class="dropdown-menu folder-list ">
            {%- if route.action != 'add' -%}
            {%- if not item %}{%- set item = context[scaffolding.singular] -%}{% endif -%}
            {% if uri_exists_with_permission(action="view", item=item) and route.action == 'edit' and application_user_level >= item.level %}<li><a href="{{ uri_action_link('view', item) }}" class="view-url"><i class="material-icons">keyboard_arrow_right</i> 檢視此項目 </a></li>{% endif %}
            {% if uri_exists_with_permission(action='edit', item=item) and route.action == 'view' and application_user_level >= item.level %}<li><a href="{{ uri_action_link('edit', item) }}" class="edit-url"><i class="material-icons">keyboard_arrow_right</i>  編輯此項目 </a></li>{% endif %}
            {% if uri_exists_with_permission(action='action_permissions', item=item) and application_user_level >= item.level %}<li><a href="{{ uri_action_link('action_permissions', item) }}"><i class="material-icons">keyboard_arrow_right</i> 修改權限 </a></li>{% endif %}
            {%- endif -%}
            {% for nav_item in scaffolding.navigation -%}
            {% if uri_exists_with_permission("admin:" + scaffolding.singular + ":" + nav_item.action, item=item) %}
            <li><a href="{{ uri_action_link(nav_item.action, item) }}"><i class="material-icons">keyboard_arrow_right</i> {{ nav_item.title }} </a></li>
            {% endif %}
            {% endfor -%}
        </ul>
    </div>
{%- endif %}
